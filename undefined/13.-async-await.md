# â¡ 13. async ì™€ await

## **ğŸ’¡**async & await

* clear style of using promise
* promiseë¥¼ ì¢€ ë” ê°„ê²°ãƒ»ê°„í¸ãƒ»ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒê°™ì´ í•´ì£¼ëŠ” ì½”ë“œ. syntactic sugar ì¼ì¢….
* syntactic sugar : ê¸°ì¡´ ì½”ë“œì™€ ê²°í•©í•´ ì¢€ ë” ê°„í¸í•œ api ì œê³µ. (ì˜ˆ: class : prototypeì— ê¸°ë°˜í•œ ì½”ë“œ)

```javascript
// 1. async
/*
function fetchUser() {
    // do network request in 10 seconds...
    return 'ellie';
}
const user = fetchUser(); // í˜¸ì¶œ
console.log(user); // ellie
*/


// Promise ìƒíƒœ 3ê°€ì§€: pedding, fulfilled, rejected
/*
function fetchUser() {
  return new Promise((resolve, reject) => {
    // do network request in 10 seconds...
    // return 'ellie'; // Promise {<pending>}
    resolve('ellie'); // Promise {<fulfilled>: "ellie"}
  });
}
*/


// async í‚¤ì›Œë“œ ì‚¬ìš© ì‹œ, Promise ì‚¬ìš© ì½”ë“œë¥¼ ë” ê°„ë‹¨íˆ í‘œí˜„ ê°€ëŠ¥.
async function fetchUser() {
    // do network request in 10 seconds...
    return 'ellie';
  }
  
const user = fetchUser(); // í˜¸ì¶œ
user.then(console.log); // ellie (ì½”ë“œ ì˜ë¯¸: userê°€ ë“¤ì–´ì˜¤ë©´, ì½˜ì†”ë¡œê·¸ì— ì¶œë ¥)
console.log(user); // Promise {<fulfilled>: "ellie"}



// 2. await

/***********************

 * ì—ëŸ¬ ì²˜ë¦¬ ì—†ëŠ” ê²½ìš°

 ***********************/

function delay(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

async function getApple() {
    await delay(2000);
    return 'ì‚¬ê³¼';
}


async function getBanana() {
    await delay(1000);
    return 'ë°”ë‚˜ë‚˜';
}



/*
// ìœ„ getBanana() í•¨ìˆ˜ë¥¼ ì•„ë˜ì²˜ëŸ¼ chainingí•´ì„œ í‘œí˜„ ê°€ëŠ¥í•˜ë‚˜, ë¹„ê¶Œì¥.
function getBanana() {
    return delay(1000)
    .then(() => 'ë°”ë‚˜ë‚˜');
}
*/


/*
// appleê³¼ bananaë¥¼ ë‘˜ ë‹¤ ì¶œë ¥í•˜ê¸°.
function pickFruits() {
    return getApple() // getApple() í˜¸ì¶œí•´ì„œ
    .then(apple => {
    // appleì´ ë°›ì•„ì™€ì§€ë©´
    return getBanana() // getBanana() ë°˜í™˜í• ê±´ë°
        .then(banana => `${apple} + ${banana}`); // banana ë°›ì•„ì™€ì§€ë©´, appleê³¼ banana ë¬¶ì–´ì¤Œ.
    });
}

pickFruits().then(console.log);


// ìœ„ ì½”ë“œëŠ” ì½œë°±ì§€ì˜¥ê³¼ ìœ ì‚¬í•œ í”„ë¼ë¯¸ìŠ¤ ì§€ì˜¥. 
// asyncãƒ»await ì‚¬ìš©í•´ ì•„ë˜ì²˜ëŸ¼ ê°„ë‹¨í•˜ê²Œ í‘œí˜„ ê°€ëŠ¥. ë‹¨, ìˆœì°¨ ì‹¤í–‰ì´ë¼ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¼.
// ì € ì•„ë˜ì—ì„œ ë³‘ë ¬ì ìœ¼ë¡œ ë” ë¹ ë¥´ê²Œ ì‹¤í–‰í•˜ëŠ” ì½”ë“œ ì†Œê°œ. 

*/


async function pickFruits() {
    const apple = await getApple(); // getApple() ë‹¤ ë°›ì•„ì˜¤ë©´ appleì— ë‹´ê¸°. (2ì´ˆ ì†Œìš”.)
    const banana = await getBanana(); // getBanana() ë‹¤ ë°›ì•„ì˜¤ë©´ bananaì— ë‹´ê¸° (ì¶”ê°€ë¡œ, 1ì´ˆ ì†Œìš”)
    return `${apple} + ${banana}`; // ë‹¤ ë°›ì•„ì˜¨ appleê³¼ bananaë¥¼ ë¬¶ì–´ ë°˜í™˜.
}


// pickFruits().then(console.log);



/***********************
 
* ì—ëŸ¬ ì²˜ë¦¬ ìˆëŠ” ê²½ìš°

***********************/

/*
function delay(ms) {
    return new Promise((resolve) => setTimeout(resolve, ms));
}

async function getApple() {
    await delay(2000);
    throw 'error';
    return 'ì‚¬ê³¼';
}


async function getBanana() {
    await delay(1000);
    return 'ë°”ë‚˜ë‚˜';
}


async function pickFruits() {
    try {
        const apple = await getApple(); // 2ì´ˆ ì†Œìš”
        const banana = await getBanana(); // ì¶”ê°€ë¡œ 1ì´ˆ ì†Œìš”
    } catch (error) {
        return 'error';
    }
    return `${apple} + ${banana}`;
}

pickFruits().then(console.log);

*/

// ìœ„ ì½”ë“œëŠ” ìˆœì°¨ì  ì‹¤í–‰ìœ¼ë¡œ ì¸í•´ ì‹œê°„ì´ ì˜¤ë˜ ì†Œìš”.
// ì„œë¡œ ë¬´ê´€ ì‹œ, ë³‘ë ¬ ì²˜ë¦¬í•˜ë©´ ì‹¤í–‰ ì‹œê°„ì„ ë‹¨ì¶• ê°€ëŠ¥.



// 4. await ë³‘ë ¬ ì²˜ë¦¬
async function pickFruits() {
    const applePromise = getApple(); // ë°”ë¡œ ì‹¤í–‰ë˜ì–´ 2ì´ˆ í›„ ì‹¤í–‰.
    const bananaPromise = getBanana(); // ìœ„ ì½”ë“œì™€ ë³‘ë ¬ì ìœ¼ë¡œ ì‹¤í–‰.
    const apple = await applePromise;
    const banana = await bananaPromise;
    return `${apple} + ${banana}`;
}

pickFruits().then(console.log); // ì‚¬ê³¼ + ë°”ë‚˜ë‚˜

// ìœ„ ì½”ë“œë¥¼ ì•„ë˜ì²˜ëŸ¼ Promise.all API ì´ìš©í•´ ë” ê°„ë‹¨íˆ í‘œí˜„ ê°€ëŠ¥.



// 3. Useful APIs

// Promise.all
function pickAllFruits() {
    return Promise.all([getApple(), getBanana()]).then((fruits) =>
        fruits.join(' + ')
    );
}

pickAllFruits().then(console.log); // ì‚¬ê³¼ + ë°”ë‚˜ë‚˜



/*
// ìœ„ í•¨ìˆ˜ë¥¼ ì•„ë˜ì²˜ëŸ¼ í‘œí˜„ë„ ê°€ëŠ¥. (ë™ì˜ìƒ ê°•ì˜ì—” ì—†ëŠ” ë‚´ìš©)

async function pickAllFruits() {
    let fruits = await Promise.all([getApple(), getBanana()]);
    return fruits.join(' + ');
}

pickAllFruits().then(console.log); // ì‚¬ê³¼ + ë°”ë‚˜ë‚˜
*/



// Promise.race
function pickOnlyOne() {
    return Promise.race([getApple(), getBanana()]);
}

pickOnlyOne().then(console.log); // ë°”ë‚˜ë‚˜
```

{% hint style="info" %}
* async, await : promiseë¥¼ ê°„ë‹¨í•˜ê²Œ í‘œí˜„ ìœ„í•œ ë„êµ¬.
* all, race : Promise ê°ì²´ì— ì†í•˜ëŠ” ìœ ìš©í•œ API
{% endhint %}
